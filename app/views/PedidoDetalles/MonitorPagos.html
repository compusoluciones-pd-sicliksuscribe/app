<div class="container" ng-swipe-right="" ng-swipe-left="">

    <div class="form-group row">
        <div class="col-xs-12 col-sm-12 col-md-8 col-lg-8">
            <h2 style="float:left;">Monitor de pedidos por pagar</h2>
        </div>
    </div>
    <div class="form-group row">
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
            <p style="float:left;">En este monitor puedes pagar los pedidos para que sean renovados en el siguiente periodo, puedes actualizar la cantidad o cancelar las suscripciones que deseas renovar en el monitor de pedidos por cliente. Se creará la factura el día de renovación
                respetando el tipo de cambio en que fue pagado el pedido. <u>Una vez pagado el pedido, no se podrá cancelar o actualizar cantidades del mismo</u>, hasta el próximo periodo se podrán realizar cambios. </p>
        </div>
    </div>

    <div class="row">
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
            <p style="float:left;">Si ya entregaste tu carta de cargos automáticos, puedes activar o desactivar que se realicen los pagos automáticamente. Los pedidos que se cobraran de manera automática son los que aparecen en este monitor. Si deseas puedes realizar el pago
                manual y no se cobrará el cargo automático.</p>
        </div>
    </div>


    <div class="row" ng-show="infoEmpresa.CartaConfirmacion2 === 1">
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
            <label><input id="RealizarCargoAutomatico" type="checkbox" ng-checked="infoEmpresa.RealizarCargoAutomatico" ng-true-value="1" ng-false-value="0" ng-model="infoEmpresa.RealizarCargoAutomatico" ng-click="ActualizarPagoAutomatico();" > Realizar cargo automático a la tarjeta.</label>
        </div>
    </div>

    <div class="row" ng-hide="DeshabilitarPagar">
      <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
          <input ng-model="paymethod" ng-click="pedidosPorPagar(key);" type="radio" name="payType" id="Tarjeta" value="1" ng-change="ActualizarFormaPago(1);" checked/> Pagar con Tarjeta
      </div>
      <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
          <input ng-model="paymethod" ng-click="pedidosPorPagar(key);" type="radio" name="payType" id="Prepago" value="4" ng-change="ActualizarFormaPago(4);" /> Transferencia
      </div>
      <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
          <input ng-disabled="!tienda" ng-model="paymethod" ng-click="pedidosPorPagar(key);" type="radio" name="payType" id="Tienda" value="5" ng-change="ActualizarFormaPago(5);" /> Pago en tienda
          <br><label ng-show="!tienda">El pago en tienda no está disponible porque cuentas con un pedido que vence en menos de 2 días.</label>
      </div>
    </div>

    <hr>
    <div class="form-group row" ng-hide="DeshabilitarPagar">
        <div class="col-xs-12 col-sm-12 col-md-3 col-lg-3">
            <label>Tipo de cambio del día: </label> {{TipoCambio | currency: "$":4}} pesos
            <br>
            <div ng-if="isPayingWithCreditCard()"><label>Servicio electrónico: </label> {{ServicioElectronico | currency}} {{Distribuidor.MonedaPago}}</div>
        </div>
        <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6">
            <label>Subtotal: </label> {{Subtotal | currency }} {{Distribuidor.MonedaPago}}
            <br>
            <label>IVA</label> {{Iva | currency}} {{Distribuidor.MonedaPago}}
            <br>
            <label>Total a pagar: </label> {{Total | currency}} {{Distribuidor.MonedaPago}}
        </div>
    </div>

    <div class="row" ng-hide="DeshabilitarPagar">
        <div class="col-xs-12 col-sm-12 col-md-3 col-lg-3">
            <input id="Activo" type="checkbox" ng-model="todos" ng-true-value="1" ng-false-value="0" ng-click="seleccionarTodos();">
            <label>Seleccionar todos</label>
        </div>
    </div>
    <hr>
    <div ng-repeat="(key, value) in Pedidos | groupBy: 'IdPedido'">
        <div class="row">



            <div class="col-xs-12 col-sm-4 col-md-6 col-lg-6">
                <input id="Activo" type="checkbox" ng-model="PedidosObj[key].Check" ng-true-value="1" ng-false-value="0" ng-click="pedidosPorPagar(key);">
                <label>Pedido N°:</label> {{key}} {{value.Estatus}}
                <br>
                <span ng-show="PedidosObj[key].CargoRealizadoProximoPedido === 9" style="font-size: 100%;" class="label label-warning">Esperando transferencia o pago en tienda.</span>
                <br>
                <label>Cliente:</label> {{PedidosObj[key].NombreEmpresa}}
                <br>
                <label>Fecha límite de pago: </label> {{PedidosObj[key].IdFabricante = 1 ? PedidosObj[key].FechaLimitePagoMS : PedidosObj[key].FechaFin | date:'yyyy-MM-dd'}}
                <br>
                <label>Tipo de Cambio: </label> {{PedidosObj[key].TipoCambio | currency: "$":4}}
                <br>
                <label>Periodo a pagar: </label> {{PedidosObj[key].IdFabricante = 1 ? PedidosObj[key].FechaInicioProximoMS : PedidosObj[key].FechaFin| date:'yyyy-MM-dd'}} - {{PedidosObj[key].FechaFinProximo| date:'yyyy-MM-dd'}}
                <br>
                <label>Precio renovación: </label> {{obtenerSubTotal(key) | currency}} pesos
                <a ng-click="mostrarDetalles(key) " style="text-decoration: none">ver detalles 
          <span class="glyphicon glyphicon-triangle-bottom " ng-show="!PedidosObj[key].Mostrar "></span>
          <span class="glyphicon glyphicon-triangle-top " ng-show="PedidosObj[key].Mostrar "></span>
        </a>
            </div>
        </div>



        <table class="table table-hover table-responsive border-left-right-cero" ng-show="PedidosObj[key].Mostrar">
            <tr ng-repeat="pedido in value | filter:PedidoFilter " class="repeat-animation">
                <td>
                    <div class="row">

                        <div class="form-group col-xs-12 col-sm-12 col-md-3 col-lg-3">
                            <label><b>{{pedido.NombreProducto}}</b></label>
                            <br>
                        </div>
                        <div class="form-group col-xs-12 col-sm-12 col-md-2 col-lg-2 ">
                            <label>Cantidad: </label> {{pedido.CantidadProxima}}
                        </div>
                        <div class="form-group col-xs-12 col-sm-12 col-md-3 col-lg-3 ">
                            <label>Precio renovación: </label> {{pedido.PrecioRenovacion | currency}} {{pedido.MonedaPrecio}}
                        </div>


                    </div>
                </td>
            </tr>
        </table>
        <hr>
    </div>

    <div ng-show="DeshabilitarPagar">
        <div class="row">
            <div class="col-xs-12 col-sm-4 col-md-6 col-lg-6">
                <h3 style="float:left;">No tienes pedidos pendientes por pagar...</h3>
            </div>
        </div>
    </div>

    <div class="form-group row" ng-hide="DeshabilitarPagar">
        <div class="col-xs-0 col-sm-0 col-md-9 col-lg-9">
        </div>
        <div class="col-xs-12 col-sm-12 col-md-3 col-lg-3">
            <div class="">
              <button ng-if = "paymethod !== CREDIT_CARD" id="btnSiguiente" type="button" ng-click="checkPayment()" class="btn btn-primary btn-block">
                Realizar Pago
              </button>
              <button ng-if = "paymethod === CREDIT_CARD" type="button" ng-click="checkPayment();" class="btn btn-primary btn-block" ng-disabled="btnComprarBloqueado" data-toggle="modal">
                  Realizar Pago
              </button>
            </div>
        </div>
    </div>
 <!-- Modal -->
 <div id="modalPagoTC" class="modal fade in"  role="dialog">
  <div class="divLoading" data-cargando>
    <div class=""><img src="images/ripple.svg" /></div>
  </div>
  <div class="modal-dialog modal-lg">
    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" ng-click = "cerrarModal('modalPagoTC')" class="close" data-dismiss="modal">
          &times;
        </button>
        <h4 class="modal-title">Open Pay</h4>
      </div>
      <div class="modal-body">
        <div class="row">
          <div class="col-md-12 col-lg-12 col-xs-12 col-sm-12">
            <div class="w100">
              <form id ="payment-form">
                <input type="hidden" name="token_id" id="token_id" />
                <!-- <input type="hidden" name="device_session_id" id="device_session_id" /> -->
                <div class="grayBackground pymnt-itm card active">
                  <h2>Tarjeta de crédito o débito</h2>
                  <div class="row">
                    <div class="col-md-12 col-lg-12">
                      <div class="alert ocultar" role="alert" id="responseDiv">
                        
                      </div>
                    </div>
                  </div>

                  <div class="row" style="margin-top: 15px;">
                    <div
                      class="grayBorder col-md-4 col-lg-4 col-sm-12 col-xs-12 hidden-sm hidden-xs"
                      style="padding-left: 40px;"
                    >
                    
                      <h4>Tarjetas de crédito</h4>
                      <img
                        src="../../../images/open-pay/cards1.png"
                        alt=""
                      />
                    </div>

                    <div
                      class="grayBorder col-md-4 col-lg-4 col-sm-12 col-xs-12 hidden-md hidden-lg hidden-xl"
                      style="padding-left: 24px;"
                    >
                      <h4>Tarjetas de crédito</h4>
                      <img
                        src="../../../images/open-pay/cards1.png"
                        alt=""
                      />
                    </div>
                    <div
                      class="col-md-8 col-lg-8 col-sm-12 col-xs-12 hidden-sm hidden-xs"
                      style="padding-left: 40px;"
                    >
                      <h4>Tarjetas de débito</h4>
                      <img
                        src="../../../images/open-pay/cards2.png"
                        alt=""
                      />
                    </div>
                    <div
                      class="col-md-8 col-lg-8 col-sm-12 col-xs-12 hidden-md hidden-lg hidden-xl"
                      style="padding-left: 24px;"
                    >
                      <h4>Tarjetas de débito</h4>
                      <img
                        src="../../../images/open-pay/debito1.PNG"
                        alt=""
                      />
                      <img
                        src="../../../images/open-pay/debito2.PNG"
                        alt=""
                      />
                    </div>
                  </div>

                  <div class="row" style="margin-top: 27px; padding-left: 20px;">
                    <div class="col-md-6 col-lg-6 col-sm-12 col-xs-12 nameAndNumber">
                      <label class="paddingTop">Nombre del titular</label>
                      <input
                        type="text"
                      
                        placeholder="Como aparece en la tarjeta"
                        data-openpay-card="holder_name"
                        id="name" name="name"
                      />
                    </div>

                    <div class="col-md-6 col-lg-6 col-sm-12 col-xs-12 nameAndNumber">
                      <label class="paddingTop">Número de tarjeta</label>
                      <input
                        type="text"
                        id="cardNumber" name="cardNumber"                              
                        data-openpay-card="card_number"
                      /><a ng-show="errorCard">{{errorCardMessage}}</a>
                    </div>
                  </div>

                  <div
                    class="row"
                    style="margin-top: 27px; padding-left: 20px;"
                  >
                    <div class="col-md-6 col-lg-6 col-sm-12 col-xs-12 nameAndNumber">
                      <label class="paddingTop">Fecha de expiración</label>
                      <div class="row">
                        <div class="col-md-6 col-lg-6 col-sm-6 col-xs-6">
                          <div class="nameAndNumber half l">
                            <select                                 
                            data-openpay-card="expiration_month"
                            id="ccexpmonth" name="ccexpmonth"
                            >
                              <option ng-repeat="mes in meses" value="{{mes.valor}}">{{mes.nombre}}</option>                                    
                          </select>
                          </div>
                        </div>
                        <div class="col-md-6 col-lg-6 col-sm-6 col-xs-6">
                          <div class="nameAndNumber half l">
                            <select                                   
                              data-openpay-card="expiration_year"
                              id="ccexpyear" name="ccexpyear"
                           >
                            <option ng-repeat="anio in anios" value="{{anio.valor}}">{{anio.nombre}}</option>                                       
                            </select>
                          </div>
                        </div>
                      </div>                            
                    </div>

                    <div
                      class="col-md-6 col-lg-6 col-sm-12 col-xs-12 nameAndNumber"
                    >
                      <label class="paddingTop">Código de seguridad</label>
                      <div class="row">
                        <div class="col-md-6 col-lg-6 col-sm-6 col-xs-12">
                          <input
                            type="text"                                 
                            placeholder="3 dígitos"                                  
                            data-openpay-card="cvv2"
                            id="cvv" name="cvv"
                          />
                        </div>
                        <div class="col-md-6 col-lg-6 col-sm-6 col-xs-12">
                          <center>
                            <img
                              src="../../../images/open-pay/cvv.png"
                              alt=""
                              class="paddingTop"
                            />
                          </center>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div
                    class="row"
                    style="margin-top: 27px; padding-left: 20px;"
                  >
                   

                    <div
                      class="col-md-6 col-lg-6 col-sm-12 col-xs-12 nameAndNumber"
                    >
                      <div class="row">
                        <div class="col-md-6 col-lg-6 col-sm-6 col-xs-6">
                          <center>
                            <div class="logo">
                              Transacciones realizadas vía:
                            </div>
                            <img
                              src="../../../images/open-pay/openpay.png"
                              class="paddingTop"
                            />
                          </center>
                        </div>
                        <div class="col-md-6 col-lg-6 col-sm-6 col-xs-6">
                          <div class="row">
                            <div
                              class="col-md-2 col-lg-2 col-sm-2 col-xs-2"
                            >
                              <img
                                src="../../../images/open-pay/security.png"
                                class="paddingTop"
                              />
                            </div>
                            <div
                              class="col-md-10 col-lg-10 col-sm-10 col-xs-10"
                            >
                              <div class="shield ">
                                Tus pagos se realizan de forma segura con
                                encriptación de 256 bits
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div
                    class="col-md-5 col-lg-5 col-sm-12 col-xs-12 nameAndNumber"
                  ></div>
                  </div>
                  <div class="row">
                    <div class="col-md-8 col-lg-8 col-sm-4 col-xs-4"></div>
                    <div class="col-md-4 col-lg-4 col-sm-8 col-xs-8 nameAndNumber">
                      <label class="totalLabel" ng-if="amount"> Total: {{amount}} {{currency}}</label>
                    </div>
                  </div>
                  <div class="row">
                    <div
                      class="col-md-10 col-lg-10 col-sm-10 col-xs-10"
                    ></div>
                    <div class="col-md-2 col-lg-2 col-sm-2 col-xs-2">
                      <div class="bkng-tb-cntnt">
                        <input type="submit" class="button text-right" id="pay-button" value="Pagar"/>
                      </div>
                    </div>
                  </div>                       
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
</div>